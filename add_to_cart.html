<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Add Crop - AgriConnect</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      background-color: #f5f5f5;
    }
    
    .navbar {
      background-color: #014034 !important;
      padding: 15px;
    }
    
    .navbar-brand {
      color: white !important;
      font-weight: bold;
    }
    
    .nav-link {
      color: white !important;
    }
    
    .nav-link:hover {
      color: rgba(255, 255, 255, 0.8) !important;
    }
    
    .btn-orange {
      background-color: #A03900;
      color: white;
    }
    
    .btn-orange:hover {
      background-color: #7a2c00;
      color: white;
    }
    
    .page-title {
      font-family: 'Playfair Display', serif;
      color: #014034;
      margin-bottom: 30px;
    }
    
    .form-container {
      max-width: 600px;
      margin: 0 auto;
    }
    
    .form-label {
      font-weight: 500;
      color: #333;
    }
    
    .btn-success {
      background-color: #0a9444;
      border-color: #0a9444;
    }
    
    .btn-success:hover {
      background-color: #078038;
      border-color: #078038;
    }
    
    footer {
      background-color: #014034;
      color: white;
      margin-top: 100px;
    }
    
    .success-message {
      padding: 15px;
      border-radius: 5px;
      background-color: #d4edda;
      color: #155724;
      margin-top: 20px;
      text-align: center;
      display: none;
    }
    
    .error-message {
      padding: 15px;
      border-radius: 5px;
      background-color: #f8d7da;
      color: #721c24;
      margin-top: 20px;
      text-align: center;
      display: none;
    }
  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container">
      <div class="d-flex align-items-center">
        <img src="image/mainlogo.png" alt="Logo" width="40" height="40" class="me-2" style="border-radius: 50%;">
        <a class="navbar-brand" href="home.html">AgriConnect</a>
      </div>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navLinks">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse justify-content-end" id="navLinks">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" href="home.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" href="farmer_dashboard.html">Dashboard</a></li>
          <li class="nav-item"><a class="nav-link" href="aboutus.html">About Us</a></li>
          <li class="nav-item"><a class="nav-link" href="support.html">Support</a></li>
          <li class="nav-item"><a class="nav-link" href="#" onclick="logout()">Logout</a></li>
          <li class="nav-item">
            <a class="btn btn-orange ms-3" href="buy.html">Buy Now</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  <!-- Google Translate -->
  <div id="google_translate_element" style="position: absolute; top: 40px; right: 10px; z-index: 1000; background-color: white; border: 1px solid black; padding: 5px;"></div>

  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'hi,ta,te,bn,ml,kn,mr,gu,pa,or,en',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE
      }, 'google_translate_element');
    }
  </script>

  <div class="container mt-5">
    <div class="form-container">
      <h2 class="page-title text-center">Add Crop Details</h2>
      <form id="cropForm" class="p-4 bg-white rounded shadow">
        <div class="mb-3">
          <label for="name" class="form-label">Crop Name (e.g. Wheat - 10kg)</label>
          <input type="text" class="form-control" id="name" required />
        </div>
        <div class="mb-3">
          <label for="price" class="form-label">Price (₹)</label>
          <input type="number" class="form-control" id="price" required />
        </div>
        <div class="mb-3">
          <label for="type" class="form-label">Type (e.g. Grain, Fruit)</label>
          <input type="text" class="form-control" id="type" required />
        </div>
        <div class="mb-3">
          <label for="minOrder" class="form-label">Minimum Order Quantity</label>
          <input type="text" class="form-control" id="minOrder" placeholder="e.g. 5kg" />
        </div>
        <div class="mb-3">
          <label for="maxOrder" class="form-label">Maximum Order Quantity</label>
          <input type="text" class="form-control" id="maxOrder" placeholder="e.g. 100kg" />
        </div>
        <div class="mb-3">
          <label for="quality" class="form-label">Quality</label>
          <select class="form-select" id="quality">
            <option value="Premium">Premium</option>
            <option value="Standard">Standard</option>
            <option value="Economy">Economy</option>
          </select>
        </div>
        <div class="mb-3">
          <label for="contact" class="form-label">Contact Number</label>
          <input type="tel" class="form-control" id="contact" placeholder="+91 XXXXX XXXXX" />
        </div>
        <div class="mb-3">
          <label for="image" class="form-label">Image URL</label>
          <input type="text" class="form-control" id="image" placeholder="https://..." />
        </div>
        <button type="submit" class="btn btn-success w-100">Add Crop</button>
      </form>
      <div id="successMessage" class="success-message">
        ✅ Crop added successfully! Redirecting...
      </div>
      <div id="errorMessage" class="error-message">
        ❌ Error: Could not add crop
      </div>
    </div>
  </div>

  <footer class="text-white pt-5 pb-4">
    <div class="container">
      <div class="row">
        <div class="col-md-4 mb-4">
          <div class="d-flex align-items-center">
            <img src="image/mainlogo.png" alt="Logo" width="40" height="40" class="me-2" style="border-radius: 50%;">
            <h5 class="mb-0 ms-2">AgriConnect</h5>
          </div>
          <p class="mt-3">Connecting Farmers & Buyers Seamlessly</p>
        </div>
        <div class="col-md-4 mb-4">
          <h6 class="text-uppercase mb-3">Contact Us</h6>
          <p>Email: <a href="mailto:business@agriconnect.com" class="text-white">business@agriconnect.com</a></p>
          <p>Phone 1: <a href="tel:+911234567890" class="text-white">+91 12345 67890</a></p>
          <p>Phone 2: <a href="tel:+919876543210" class="text-white">+91 98765 43210</a></p>
        </div>
        <div class="col-md-4 mb-4">
          <h6 class="text-uppercase mb-3">Quick Actions</h6>
          <a href="support.html" class="btn btn-outline-light btn-sm mb-2">Complaint</a><br>
          <a href="login-signin.html" class="btn btn-light btn-sm text-dark">Login / Signup</a>
        </div>
      </div>
      <hr class="border-white" />
      <div class="text-center">
        &copy; 2025 AgriConnect. All rights reserved.
      </div>
    </div>
  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";
    
    const firebaseConfig = {
      apiKey: "AIzaSyAXWHJCoMfBOG_HAEkAmn2B59610Z1PRew",
      authDomain: "agriconnect-e5951.firebaseapp.com",
      projectId: "agriconnect-e5951",
      storageBucket: "agriconnect-e5951.firebasestorage.app",
      messagingSenderId: "778997833951",
      appId: "1:778997833951:web:2a38072c5e4a2be93ac96a",
      measurementId: "G-34P7ZK4HKM"
    };
    
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    
    // Make logout function available globally
    window.logout = function() {
      signOut(auth).then(() => {
        window.location.href = "login-signin.html";
      }).catch((error) => {
        console.error("Error signing out:", error);
      });
    };
    
    // Check user authentication
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        alert("Please login first!");
        window.location.href = "login-signin.html";
      }
    });
    
    // Form submission
    document.getElementById('cropForm').addEventListener('submit', async (e) => {
      e.preventDefault();
      
      const name = document.getElementById('name').value;
      const price = parseFloat(document.getElementById('price').value);
      const type = document.getElementById('type').value;
      const image = document.getElementById('image').value;
      const minOrder = document.getElementById('minOrder').value;
      const maxOrder = document.getElementById('maxOrder').value;
      const quality = document.getElementById('quality').value;
      const contact = document.getElementById('contact').value;
      
      const successMsg = document.getElementById('successMessage');
      const errorMsg = document.getElementById('errorMessage');
      
      try {
        // Add to both collections to ensure compatibility
        await addDoc(collection(db, "crops"), { 
          productName: name, 
          price, 
          type, 
          image, 
          minOrder, 
          maxOrder, 
          quality, 
          contact 
        });
        
        // Also add to the "crop" collection for backward compatibility
        await addDoc(collection(db, "crop"), { 
          name, 
          price, 
          type, 
          image, 
          minOrder, 
          maxOrder, 
          quality, 
          contact 
        });
        
        successMsg.style.display = "block";
        errorMsg.style.display = "none";
        
        // Reset form
        document.getElementById('cropForm').reset();
        
        // Redirect after delay
        setTimeout(() => {
          window.location.href = "farmer_dashboard.html";
        }, 1500);
      } catch (error) {
        console.error("Error adding crop:", error);
        errorMsg.textContent = "❌ Error: " + error.message;
        errorMsg.style.display = "block";
        successMsg.style.display = "none";
      }
    });
  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
